= Application IoT

== Sommaire

1. Présentation de l'application
2. Use Case global
3. Architecture
    1. Architecture générale
    2. Ressources externes utilisées
    3. Structuration en packages
    4. Éléments essentiels
4. Fonctionnalités
5. Procédures d'installation
    1. Pour le développement
    2. Pour l'utilisateur final

== Présentation de l'application

Cette application IoT permet de surveiller et d'afficher les données de capteurs AM107 et SolarEdge. Elle se compose d'une interface graphique développée en JavaFX et d'un script Python pour la collecte des données via MQTT.

== Use Case global

L'application est destinée aux utilisateurs souhaitant surveiller en temps réel les données environnementales et énergétiques collectées par les capteurs AM107 (température, humidité, CO2, etc.) et SolarEdge (production énergétique). Les utilisateurs peuvent visualiser les données, configurer les seuils d'alerte et gérer les salles et capteurs à surveiller.

== Architecture

=== Architecture générale

L'application est divisée en deux sous-systèmes principaux :

- **Interface graphique JavaFX** : Fournit une interface utilisateur pour la visualisation des données et la configuration des paramètres.
- **Script Python** : Gère la collecte des données des capteurs via MQTT, le traitement des données et la génération de fichiers JSON pour l'interface JavaFX.

Les données sont transmises du script Python à l'application JavaFX via des fichiers JSON placés dans le répertoire 

resultat

.

=== Ressources externes utilisées

- **MQTT Broker** : `mqtt.iut-blagnac.fr` pour la réception des données des capteurs.
- **Paho MQTT** : Bibliothèque utilisée pour la communication MQTT en Python.
- **JavaFX** : Framework pour le développement de l'interface graphique en Java.
- **JSON** : Format utilisé pour l'échange de données entre le script Python et l'application JavaFX.

=== Structuration en packages

L'application JavaFX est structurée en plusieurs packages pour organiser le code de manière logique :

- 

application.control

 : Contient les classes de contrôle, comme 

AppMainFrame

 et les contrôleurs spécifiques aux capteurs.
- 

application.view

 : Contient les classes de vue, telles que `Am107ViewController` et `SolarEdgeViewController`.
- 

application.tools

 : Fournit des utilitaires comme 

StageManagement

 pour la gestion des fenêtres.
- 

model

 : Contient les classes modèles comme 

Config

 pour gérer les configurations.

Le pattern **MVC (Modèle-Vue-Contrôleur)** est utilisé pour séparer les responsabilités entre la logique de contrôle, l'interface utilisateur et les données.

=== Éléments essentiels

- **Gestion des threads** : L'application utilise des threads pour rafraîchir les données affichées sans bloquer l'interface utilisateur.
- **Communication inter-processus** : Le script Python est exécuté en arrière-plan depuis l'application JavaFX pour collecter les données en continu.
- **Gestion des configurations** : Les paramètres de l'application sont chargés à partir du fichier 

config.json

 et peuvent être modifiés via l'interface graphique.

== Fonctionnalités

- **Affichage des données des capteurs AM107** : Visualisation en temps réel des mesures de température, humidité, CO₂, etc.
    - *Classes impliquées* :
        - `Am107ViewController` dans 

application.view


        - `Am107BorderPane` dans 

application.control


    - *Éléments essentiels* :
        - Rafraîchissement des graphiques à partir des données du fichier 

resultatAM107.json

.
        - Gestion des alertes en fonction des seuils définis.

- **Affichage des données SolarEdge** : Visualisation des données de production énergétique.
    - *Classes impliquées* :
        - `SolarEdgeViewController` dans 

application.view


        - `SolarEdgeBorderPane` dans 

application.control


    - *Éléments essentiels* :
        - Mise à jour des graphiques en se basant sur le fichier 

resultatSolar.json

.
        - Affichage de l'historique de production énergétique.

- **Configuration des paramètres** : Gestion des salles, capteurs, seuils d'alerte et fréquence de rafraîchissement.
    - *Classes impliquées* :
        - 

AppMainFrameViewController

 dans 

application.view


        - 

Config

 dans 

model


    - *Éléments essentiels* :
        - Modification et sauvegarde de la configuration via le fichier 

config.json

.
        - Interaction avec l'utilisateur pour personnaliser l'application.

== Procédures d'installation

=== Pour le développement

1. **Prérequis** :
    - Java Development Kit (JDK) 21 ou supérieur
    - Maven 3.6 ou supérieur
    - Python 3.x avec `pip`

2. **Cloner le dépôt** :
    ```sh
    git clone <URL_DU_DÉPÔT>
    cd <NOM_DU_RÉPERTOIRE>
    ```

3. **Installer les dépendances Java** :
    ```sh
    cd IoT/JavaFX
    mvn clean install
    ```

4. **Installer les dépendances Python** :
    ```sh
    cd ../Python
    python -m venv venv
    # Sous Windows :
    venv\Scripts\activate
    # Sous Linux/macOS :
    source venv/bin/activate
    pip install -r requirements.txt
    ```

5. **Configurations supplémentaires** :
    - Vérifier que le fichier 

config.json

 est correctement configuré.
    - S'assurer que les chemins relatifs dans le code pointent vers les bons emplacements.

=== Pour l'utilisateur final

1. **Lancer l'application JavaFX** :
    - Naviguez dans le répertoire `IoT/JavaFX`.
    - Exécutez la commande :
    ```sh
    mvn javafx:run
    ```
    - Ou exécutez le fichier exécutable généré après la compilation.

2. **Le script Python** :
    - Le script Python 

main.py

 est automatiquement lancé par l'application JavaFX pour collecter les données des capteurs.
    - Assurez-vous que l'environnement Python est disponible et que les dépendances sont installées.

3. **Utilisation de l'application** :
    - Une fois l'application lancée, vous pouvez configurer les paramètres selon vos besoins.
    - Les données seront affichées en temps réel, et les alertes seront générées en fonction des seuils définis.